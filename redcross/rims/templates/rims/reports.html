{% extends "rims/home.html" %}
{% load staticfiles %}
{% block extra_scripts %}
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css"> 
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <script>
        $(document).ready(function() {
            $('.datepicker').datepicker();
            var startDate = "{{ startDate }}";
            startDate = startDate.replace(/-/g,'/');
            var stopDate = "{{ stopDate }}";
            stopDate = stopDate.replace(/-/g,'/');
            $( '#id_startDate' ).val( startDate );
            $( '#id_stopDate' ).val( stopDate );
            $("#printButton").click(function(){
                printElem('#rims-report');
            });
        });
        function printElem(elem) {
            popup($(elem).html());
        }

        function popup(data) {
            var mywindow = window.open('', 'site inventory report', 'height=300px,width=1000px');
            mywindow.document.write('<html><head>');
            mywindow.document.write('<link rel="stylesheet" href="{% static 'rims/style/style.css' %}" type="text/css" />');
            mywindow.document.write('</head><body >');
            mywindow.document.write(data);
            mywindow.document.write('</body></html>');
            mywindow.document.close(); // necessary for IE >= 10
            mywindow.focus(); // necessary for IE >= 10
            mywindow.print();
            mywindow.close();
            return true;
        }
    </script>
{% endblock extra_scripts %}
{% block breadcrumbs %}
    {{ block.super }}
    &raquo;
    <a href="{% url 'rims:reports' %}">reports</a>
{% endblock breadcrumbs %}
{% block content %}
    <form action="{% url 'rims:reports_dates' startDate=startDate stopDate=stopDate %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
        <table class="inline-table">
            <tr>
                <th colspan="2">
                    Report Dates
                </th>
            </tr>
            <tr>
                <td>
                    {{ dateSpanForm }}
                </td>
            </tr>
        </table>
        <span class="h4-font">Region</span>
        <select name="region">
            {% for region in regionList %}
                <option value="{{ region | lower | slugify }}">{{ region }}</option>
            {% endfor %}
        </select>
        {% if warningMessage %}
            <h3>{{ warningMessage }}</h3>
        {% endif %}
        <table>
            <tr>
                <th colspan="2">
                    <h3>Reports:</h3>
                </th>
            </tr>
            <tr>
                <td class="cell-frame">
                    <table id="report-table">
                        <tr class="bottom-bordered-row">
                            <th class="left-column report-column">
                                Site Reports
                            </th>
                            <th class="right-column  report-column">
                                Product Reports
                            </th>
                        </tr>
                        <tr>
                            <th class="left-column cell-center-btn">
                                Site Inventory
                            </th>
                            <th class="right-column cell-center-btn">
                                Inventory Detail
                            </th>
                        </tr>
                        <tr class="bottom-bordered-row">
                            <td class="left-column report-column">
                                <input class="cell-left-btn" type="submit" name="Site Inventory Print" value="print view">
                                <input class="cell-right-btn" type="submit" name="Site Inventory XLS" value="xls">
                            </td>
                            <td class="right-column">
                                <input class="cell-left-btn" type="submit" name="Inventory Detail Print" value="print view">
                                <input class="cell-right-btn" type="submit" name="Inventory Detail XLS" value="xls">
                            </td>
                        </tr>
                        <tr>
                            <th class="left-column cell-center-btn">
                                
                            </th>
                            <th class="right-column cell-center-btn">
                                Inventory Status
                            </th>
                        </tr>
                        <tr class="bottom-bordered-row">
                            <td class="left-column">
                                
                            </td>
                            <td class="right-column">
                                <input class="cell-left-btn" type="submit" name="Inventory Status Print" value="print view">
                                <input class="cell-right-btn" type="submit" name="Inventory Status XLS" value="xls">
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </form>
    <br />
    {% if report == "site_inventory_print" and sitesList %}
        {% include "rims/site_inventory_print.html" %}
    {% elif report == "site_inventory_xls" and sitesList %}
        <h3>Site Inventory Excel Report Not Yet Available</h3>
    {% elif report == "inventory_detail_print" and sitesList %}
        {% include "rims/inventory_detail_print.html" %}
    {% elif report == "inventory_detail_xls" and sitesList %}
        <h3>Inventory Detail Excel Report Not Yet Available</h3>
    {% elif report == "inventory_status_print" and sitesList %}
        {% include "rims/inventory_status_print.html" %}
    {% elif report == "inventory_status_xls" and sitesList %}
        <h3>Inventory Status Excel Report Not Yet Available</h3>
    {% endif %}
{% endblock content %}